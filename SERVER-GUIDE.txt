================================================================================
                  도서관 관리 시스템 - 서버 관리 가이드
================================================================================

GitHub: https://github.com/Kontrack/library
Domain: https://library.kontrack.kr

================================================================================
📂 파일 구조 (서버 배포용)
================================================================================

release/
│
├── 🚀 관리 스크립트 (8개)
│   ├── deploy.sh              프로덕션 배포
│   ├── start.sh               MySQL 시작
│   ├── stop.sh                MySQL 중지
│   ├── restart.sh             MySQL 재시작
│   ├── rebuild.sh             MySQL 재빌드
│   ├── update.sh              Git pull + 자동 배포 ⭐
│   ├── health.sh              상태 종합 확인 ⭐
│   ├── logs.sh                로그 확인 ⭐
│   └── setup-permissions.sh   실행 권한 설정
│
├── ⚙️  설정 파일 (2개)
│   ├── docker-compose.yml         MySQL 컨테이너 설정
│   └── nginx-library-config.txt   Nginx 설정 템플릿
│
├── 📚 문서 (4개)
│   ├── README.txt                 프로젝트 개요 ⭐
│   ├── SERVER-GUIDE.txt           이 파일
│   ├── README-DEPLOYMENT.txt      상세 배포 가이드
│   ├── PROJECT-SUMMARY.txt        프로젝트 요약
│   └── GitHub사용가이드.md        Git 가이드 (gitignore됨)
│
└── 🌐 웹 프론트엔드
    └── public/
        ├── index.html         로그인 페이지
        ├── register.html      회원가입 페이지
        ├── main.html          메인 페이지
        ├── css/ (4개)
        └── js/ (3개)


================================================================================
🚀 빠른 시작 (3단계)
================================================================================

1️⃣  실행 권한 부여 (최초 1회)
   chmod +x *.sh

2️⃣  프로덕션 배포
   ./deploy.sh
   → 옵션 1 선택

3️⃣  확인
   https://library.kontrack.kr 접속


================================================================================
💡 일상 사용 명령어
================================================================================

┌─────────────────────────────────────────────────────────────────────────┐
│ 아침 시작                                                                │
│   ./start.sh && ./health.sh                                             │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ 상태 확인                                                                │
│   ./health.sh                                                           │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ 로그 확인                                                                │
│   ./logs.sh                                                             │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ 코드 업데이트 (Git pull + 재배포)                                         │
│   ./update.sh                                                           │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ 재시작                                                                   │
│   ./restart.sh                                                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ 퇴근 중지                                                                │
│   ./stop.sh                                                             │
└─────────────────────────────────────────────────────────────────────────┘


================================================================================
📊 스크립트 상세
================================================================================

deploy.sh
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  프로덕션 배포 스크립트
  1. 웹 파일을 /usr/share/nginx/html/library/ 로 복사
  2. Nginx 설정 자동 생성 및 활성화
  3. SSL 인증서 자동 발급 (Let's Encrypt)
  4. MySQL 컨테이너 시작
  
  사용: ./deploy.sh → 옵션 1 선택

update.sh ⭐
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  자동 업데이트 스크립트
  1. Git pull (최신 코드)
  2. 웹 파일 자동 복사
  3. MySQL 컨테이너 재시작
  
  사용: ./update.sh

health.sh ⭐
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  시스템 상태 종합 확인
  - MySQL 상태 및 응답
  - 웹서버 HTTPS 응답 (library.kontrack.kr)
  - Nginx 서비스 상태
  - 리소스 사용량
  
  사용: ./health.sh

logs.sh ⭐
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  로그 확인 (대화형)
  1) MySQL 로그
  2) Nginx 로그 (시스템)
  3) 실시간 MySQL 로그
  4) 최근 50줄
  
  사용: ./logs.sh

start.sh
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  MySQL 컨테이너 시작
  사용: ./start.sh

stop.sh
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  MySQL 컨테이너 중지
  사용: ./stop.sh

restart.sh
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  MySQL 컨테이너 재시작
  사용: ./restart.sh

rebuild.sh
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  MySQL 이미지 완전 재빌드 (캐시 없이)
  사용: ./rebuild.sh


================================================================================
🔄 워크플로우
================================================================================

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 최초 배포 (서버 셋업)                                                  ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
  git clone git@github.com:Kontrack/library.git
  cd library
  chmod +x *.sh
  ./deploy.sh    # 옵션 1 선택

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 매일 아침 루틴                                                         ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
  ./start.sh && ./health.sh

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 코드 수정 후 배포                                                      ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
  # 로컬에서
  git add .
  git commit -m "메시지"
  git push
  
  # 서버에서
  ./update.sh

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 문제 발생 시                                                           ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
  1. ./health.sh     # 상태 확인
  2. ./logs.sh       # 로그 확인
  3. ./restart.sh    # 재시작
  4. ./rebuild.sh    # 재빌드 (필요시)

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 퇴근 시                                                                ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
  ./stop.sh


================================================================================
📱 접속 정보
================================================================================

웹 접속:    https://library.kontrack.kr

MySQL:      localhost:3307
Database:   library
User:       root
Password:   library2024

웹 파일:    /usr/share/nginx/html/library/
Nginx 설정: /etc/nginx/sites-available/library.kontrack.kr


================================================================================
🔧 문제 해결
================================================================================

❌ 권한 오류
   chmod +x *.sh

❌ Git pull 실패
   ssh -T git@github.com
   # SSH 키 설정 확인

❌ 웹사이트 접속 안됨
   sudo nginx -t
   sudo systemctl status nginx
   sudo systemctl reload nginx

❌ MySQL 접속 안됨
   docker-compose ps library-mysql
   ./logs.sh    # 옵션 1 선택
   ./restart.sh

❌ 포트 충돌
   # 3307 포트 사용 확인
   netstat -tlnp | grep 3307


================================================================================
💡 유용한 팁
================================================================================

# 자동 업데이트 (크론탭)
crontab -e
0 3 * * * cd /path/to/library && ./update.sh >> /tmp/library-update.log 2>&1

# 백업
docker-compose exec library-mysql mysqldump -u root -plibrary2024 library > backup.sql

# 복원
docker-compose exec -T library-mysql mysql -u root -plibrary2024 library < backup.sql

# 직접 MySQL 접속
docker-compose exec library-mysql mysql -u root -plibrary2024

# Nginx 로그 실시간 확인
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log


================================================================================
📚 추가 문서
================================================================================

README.txt              - 프로젝트 개요 및 빠른 시작
README-DEPLOYMENT.txt   - 상세 배포 가이드
PROJECT-SUMMARY.txt     - 프로젝트 전체 요약
GitHub사용가이드.md     - Git/GitHub 사용법


================================================================================
                    서버 관리 가이드 끝 - 즐거운 관리 되세요! 🚀
================================================================================

